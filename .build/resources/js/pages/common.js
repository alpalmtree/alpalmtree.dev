(()=>{var i=class e extends HTMLElement{static init=()=>customElements.get("x-toggle")?null:customElements.define("x-toggle",e);constructor(){super(),this.addEventListener("change",this)}checkbox=this.querySelector("input");html=document.querySelector("html");handleEvent=()=>{this.checkbox.checked?(this.html.dataset.theme="dark",localStorage.setItem("prefers_schema","dark")):(this.html.dataset.theme="light",localStorage.setItem("prefers_schema","light"))};connectedCallback(){let t=globalThis.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",r=localStorage.getItem("prefers_schema");if(r){this.html.dataset.theme=r,this.checkbox.checked=r==="dark";return}this.html.dataset.theme=t,this.checkbox.checked=t==="dark"}};i.init();var h=(e,t)=>e.hasAttribute("href")||e.hasAttribute("src")?e.outerHTML.replace(/\?rel=\d+/g,"")===t.outerHTML.replace(/\?rel=\d+/g,""):e.isEqualNode(t),d=async e=>{let r=await(await fetch(e)).text(),o=new DOMParser().parseFromString(r,"text/html"),s=document.querySelector("head"),l=o.querySelector("head"),m=o.querySelector("view-partial"),n=[];for(let a of s.children)[...l.children].some(c=>h(a,c))||n.push(a);for(let a of l.children)[...s.children].some(c=>h(a,c))||s.append(a);n.forEach(a=>a.remove()),document.querySelector("view-partial").replaceWith(m),document.querySelector("header").scrollIntoView()};globalThis.addEventListener("page:changed",async({detail:e})=>{document.startViewTransition?.(async()=>{await d(e)})??await d(e)});globalThis.addEventListener("popstate",()=>{globalThis.dispatchEvent(new CustomEvent("page:changed",{detail:globalThis.location.pathname}))});globalThis.addEventListener("click",e=>{if(e.target?.tagName!=="A"||e.target.origin!==globalThis.location.origin)return;e.preventDefault();let t=e.target.getAttribute("href");globalThis.history.pushState("",null,t),globalThis.dispatchEvent(new CustomEvent("page:changed",{detail:t}))});customElements.define("view-partial",class extends HTMLElement{#e=this.getAttribute("script");constructor(){super()}async connectedCallback(){if(!this.#e)return;let{default:e}=await import(this.#e);e?.()}});})();
